{"ast":null,"code":"import React,{useState}from\"react\";import{uploadFileAPI,retrieveFileAPI}from\"../api/fileAPI\";import\"../styles/ShareReceivePage.css\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function ShareReceivePage(){const[selectedFile,setSelectedFile]=useState(null);const[fileDetails,setFileDetails]=useState(null);const[accessCode,setAccessCode]=useState(\"\");const[receiveAccessCode,setReceiveAccessCode]=useState(\"\");const[receivedFileInfo,setReceivedFileInfo]=useState(null);const handleFileChange=event=>{const file=event.target.files[0];setSelectedFile(file);if(file){setFileDetails({name:file.name,size:file.size,// Size in bytes\ntype:file.type});}};const handleShareSubmit=async event=>{event.preventDefault();if(!selectedFile)return;const userId=localStorage.getItem(\"userId\");const token=localStorage.getItem(\"authToken\");if(!userId||!token){alert(\"You must be logged in to upload a file.\");return;}const mediaType=selectedFile.type.split(\"/\")[0];// e.g., \"text\", \"image\"\nconst format=selectedFile.name.split(\".\").pop();// File extension\ntry{const response=await uploadFileAPI(userId,token,selectedFile,mediaType,\".\".concat(format));setAccessCode(response.access_code);}catch(error){console.error(\"Error sharing file:\",error);alert(\"Failed to upload file. Please try again.\");}};const handleReceiveSubmit=async event=>{event.preventDefault();if(!receiveAccessCode)return;const userId=localStorage.getItem(\"userId\");const token=localStorage.getItem(\"authToken\");if(!userId||!token){alert(\"You must be logged in to retrieve a file.\");return;}try{const response=await retrieveFileAPI(userId,token,receiveAccessCode);setReceivedFileInfo({name:response.file_name||\"Unknown\",size:response.file_size||\"Unknown\",downloadLink:response.file_download_url||null});}catch(error){console.error(\"Error retrieving file:\",error);alert(\"Failed to retrieve file. Please check the access code and try again.\");}};const handleDownload=async()=>{try{const response=await fetch(receivedFileInfo.downloadLink);if(!response.ok){throw new Error(\"Failed to fetch the file\");}const blob=await response.blob();const downloadUrl=window.URL.createObjectURL(blob);const link=document.createElement(\"a\");link.href=downloadUrl;link.download=receivedFileInfo.name||\"downloaded-file.txt\";document.body.appendChild(link);link.click();document.body.removeChild(link);window.URL.revokeObjectURL(downloadUrl);}catch(error){console.error(\"Error downloading the file:\",error);alert(\"Failed to download the file. Please try again.\");}};return/*#__PURE__*/_jsxs(\"div\",{className:\"share-receive-container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"share-section\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Share Your Files\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleShareSubmit,className:\"share-form\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"file\",onChange:handleFileChange,className:\"file-input\"}),fileDetails&&/*#__PURE__*/_jsxs(\"div\",{className:\"file-details\",children:[/*#__PURE__*/_jsxs(\"p\",{children:[\"Name: \",fileDetails.name]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Size: \",fileDetails.size,\" Bytes\"]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Type: \",fileDetails.type]})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"upload-button\",children:\"Upload\"})]}),accessCode&&/*#__PURE__*/_jsx(\"div\",{className:\"access-code\",children:/*#__PURE__*/_jsxs(\"p\",{children:[\"Your access code: \",accessCode]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"receive-section\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Receive a File\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleReceiveSubmit,className:\"receive-form\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Enter Access Code\",value:receiveAccessCode,onChange:e=>setReceiveAccessCode(e.target.value),className:\"access-code-input\"}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"retrieve-button\",children:\"Retrieve File\"})]}),receivedFileInfo&&/*#__PURE__*/_jsxs(\"div\",{className:\"file-info\",children:[/*#__PURE__*/_jsxs(\"p\",{children:[\"File Name: \",receivedFileInfo.name]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"File Size: \",receivedFileInfo.size,\" Bytes\"]}),/*#__PURE__*/_jsx(\"button\",{className:\"download-button\",onClick:handleDownload,children:\"Download File\"})]})]})]});}export default ShareReceivePage;","map":{"version":3,"names":["React","useState","uploadFileAPI","retrieveFileAPI","jsx","_jsx","jsxs","_jsxs","ShareReceivePage","selectedFile","setSelectedFile","fileDetails","setFileDetails","accessCode","setAccessCode","receiveAccessCode","setReceiveAccessCode","receivedFileInfo","setReceivedFileInfo","handleFileChange","event","file","target","files","name","size","type","handleShareSubmit","preventDefault","userId","localStorage","getItem","token","alert","mediaType","split","format","pop","response","concat","access_code","error","console","handleReceiveSubmit","file_name","file_size","downloadLink","file_download_url","handleDownload","fetch","ok","Error","blob","downloadUrl","window","URL","createObjectURL","link","document","createElement","href","download","body","appendChild","click","removeChild","revokeObjectURL","className","children","onSubmit","onChange","placeholder","value","e","onClick"],"sources":["C:/Users/popul/Documents/Programming/Sendable/src/pages/ShareReceivePage.jsx"],"sourcesContent":["import React, { useState } from \"react\";\r\nimport { uploadFileAPI, retrieveFileAPI } from \"../api/fileAPI\";\r\nimport \"../styles/ShareReceivePage.css\";\r\n\r\nfunction ShareReceivePage() {\r\n  const [selectedFile, setSelectedFile] = useState(null);\r\n  const [fileDetails, setFileDetails] = useState(null);\r\n  const [accessCode, setAccessCode] = useState(\"\");\r\n  const [receiveAccessCode, setReceiveAccessCode] = useState(\"\");\r\n  const [receivedFileInfo, setReceivedFileInfo] = useState(null);\r\n\r\n  const handleFileChange = (event) => {\r\n    const file = event.target.files[0];\r\n    setSelectedFile(file);\r\n    if (file) {\r\n      setFileDetails({\r\n        name: file.name,\r\n        size: file.size, // Size in bytes\r\n        type: file.type,\r\n      });\r\n    }\r\n  };\r\n\r\n  const handleShareSubmit = async (event) => {\r\n    event.preventDefault();\r\n    if (!selectedFile) return;\r\n\r\n    const userId = localStorage.getItem(\"userId\");\r\n    const token = localStorage.getItem(\"authToken\");\r\n\r\n    if (!userId || !token) {\r\n      alert(\"You must be logged in to upload a file.\");\r\n      return;\r\n    }\r\n\r\n    const mediaType = selectedFile.type.split(\"/\")[0]; // e.g., \"text\", \"image\"\r\n    const format = selectedFile.name.split(\".\").pop(); // File extension\r\n\r\n    try {\r\n      const response = await uploadFileAPI(userId, token, selectedFile, mediaType, `.${format}`);\r\n      setAccessCode(response.access_code);\r\n    } catch (error) {\r\n      console.error(\"Error sharing file:\", error);\r\n      alert(\"Failed to upload file. Please try again.\");\r\n    }\r\n  };\r\n\r\n  const handleReceiveSubmit = async (event) => {\r\n    event.preventDefault();\r\n    if (!receiveAccessCode) return;\r\n  \r\n    const userId = localStorage.getItem(\"userId\");\r\n    const token = localStorage.getItem(\"authToken\");\r\n  \r\n    if (!userId || !token) {\r\n      alert(\"You must be logged in to retrieve a file.\");\r\n      return;\r\n    }\r\n  \r\n    try {\r\n      const response = await retrieveFileAPI(userId, token, receiveAccessCode);\r\n      setReceivedFileInfo({\r\n        name: response.file_name || \"Unknown\",\r\n        size: response.file_size || \"Unknown\",\r\n        downloadLink: response.file_download_url || null,\r\n      });\r\n    } catch (error) {\r\n      console.error(\"Error retrieving file:\", error);\r\n      alert(\"Failed to retrieve file. Please check the access code and try again.\");\r\n    }\r\n  };\r\n\r\n  const handleDownload = async () => {\r\n    try {\r\n      const response = await fetch(receivedFileInfo.downloadLink);\r\n      if (!response.ok) {\r\n        throw new Error(\"Failed to fetch the file\");\r\n      }\r\n  \r\n      const blob = await response.blob();\r\n  \r\n      const downloadUrl = window.URL.createObjectURL(blob);\r\n  \r\n      const link = document.createElement(\"a\");\r\n      link.href = downloadUrl;\r\n      link.download = receivedFileInfo.name || \"downloaded-file.txt\";\r\n      document.body.appendChild(link);\r\n      link.click();\r\n  \r\n      document.body.removeChild(link);\r\n      window.URL.revokeObjectURL(downloadUrl);\r\n    } catch (error) {\r\n      console.error(\"Error downloading the file:\", error);\r\n      alert(\"Failed to download the file. Please try again.\");\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"share-receive-container\">\r\n      <div className=\"share-section\">\r\n        <h1>Share Your Files</h1>\r\n        <form onSubmit={handleShareSubmit} className=\"share-form\">\r\n          <input\r\n            type=\"file\"\r\n            onChange={handleFileChange}\r\n            className=\"file-input\"\r\n          />\r\n          {fileDetails && (\r\n            <div className=\"file-details\">\r\n              <p>Name: {fileDetails.name}</p>\r\n              <p>Size: {fileDetails.size} Bytes</p>\r\n              <p>Type: {fileDetails.type}</p>\r\n            </div>\r\n          )}\r\n          <button type=\"submit\" className=\"upload-button\">\r\n            Upload\r\n          </button>\r\n        </form>\r\n        {accessCode && (\r\n          <div className=\"access-code\">\r\n            <p>Your access code: {accessCode}</p>\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      <div className=\"receive-section\">\r\n        <h1>Receive a File</h1>\r\n        <form onSubmit={handleReceiveSubmit} className=\"receive-form\">\r\n          <input\r\n            type=\"text\"\r\n            placeholder=\"Enter Access Code\"\r\n            value={receiveAccessCode}\r\n            onChange={(e) => setReceiveAccessCode(e.target.value)}\r\n            className=\"access-code-input\"\r\n          />\r\n          <button type=\"submit\" className=\"retrieve-button\">\r\n            Retrieve File\r\n          </button>\r\n        </form>\r\n        {receivedFileInfo && (\r\n          <div className=\"file-info\">\r\n          <p>File Name: {receivedFileInfo.name}</p>\r\n          <p>File Size: {receivedFileInfo.size} Bytes</p>\r\n          <button className=\"download-button\" onClick={handleDownload}>\r\n            Download File\r\n          </button>\r\n        </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default ShareReceivePage;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}